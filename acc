#!/usr/local/bin/sharpl

(define commands {})

(^add-command [name imp]
  (commands name imp))

(^find-command [name]
  (commands name))

(^bye []
  (term/reset)
  (term/clear-screen)
  (term/move-to 1 1)
  (term/flush))

(^right-align [text col]
  (term/move-to (+ (- col (length text)) 1) _)
  (term/write text))

(^draw-header []
  (term/move-to 1 1)
  (term/clear-line)
  (term/set-fg (rgb 255 0 0))
  (right-align "acc v1" (term/width)))

(^read-command []
  (let [k (term/read-key)]
    (term/save)
    (draw-header)
    (term/move-to 1 1)
    (term/set-fg (rgb 255 0 0))
    (term/write k)
    (term/restore))
  (return (read-command)))

(term/clear-screen)
(draw-header)

(term/move-to 1 (term/height))
(term/set-fg (rgb 255 0 0))
(term/write ": ")

(let [commands {}]
  (add-command "create-account" (^[]
    ))
    
  (let [c (read-command)]
    (if c (c))))

(bye)